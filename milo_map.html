<!DOCTYPE html>
<html>
  <head>
    <!-- google fonts  -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- leaflet css -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
      integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
      crossorigin=""
    />

    <!-- leaflet js -->
    <script
      src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
      integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
      crossorigin=""
    ></script>

    <title>Milo's Local Community</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <style>
      body {
        margin: 0;
        padding: 0;
      }

      #map {
        height: 100vh;
        width: 100%;
      }

      .material-icons-map {
        font-family: 'Material Icons';
        font-size: 32px;
        text-align: center;
        line-height: 32px;
      }

      .main-street-icon {
        color: #2196F3; /* Blue color for Main Street */
      }

      .default-icon {
        color: #FF5722; /* Orange color for other types */
      }

      .popup-content {
        font-family: 'Arial', sans-serif;
        color: #333;
        background-color: #f9f9f9;
        border-radius: 8px;
        padding: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }

      .popup-content h1 {
        font-size: 18px;
        color: #FF5722;
        margin: 0 0 10px;
      }

      .popup-content p {
        font-size: 14px;
        color: #2196F3;
        margin: 5px 0;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
  </body>

  <script>
    // basic leaflet map with setview
    var map = L.map("map").setView([38.6609, -90.4226], 13);

    // OpenStreetMap map
    var osmMap = L.tileLayer(
      "http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",
      {
        maxZoom: 19,
        attribution:
          '&copy; <a href="https://carto.com/attribution">CartoDB</a> contributors',
      }
    ).addTo(map);

    // Define custom icons using Material Icons
    var mainStreetIcon = L.divIcon({
      className: 'material-icons-map main-street-icon',
      html: 'info', // Material icon name for Main Street
      iconSize: [32, 32],
      iconAnchor: [16, 32],
      popupAnchor: [0, -32]
    });

    var defaultIcon = L.divIcon({
      className: 'material-icons-map default-icon',
      html: 'feedback', // Material icon name for other types
      iconSize: [32, 32],
      iconAnchor: [16, 32],
      popupAnchor: [0, -32]
    });

    // Use the custom icons based on the Type field
    fetch("./data/poi.geojson")
      .then((response) => response.json())
      .then((data) => {
        L.geoJSON(data, {
          pointToLayer: function (feature, latlng) {
            let icon;
            switch (feature.properties.Type) {
              case "Main Street":
                icon = mainStreetIcon;
                break;
              default:
                icon = defaultIcon;
            }
            return L.marker(latlng, { icon: icon });
          },
          onEachFeature: function (feature, layer) {
            const name = feature.properties.Name || "No Name";
            const notes = feature.properties.NOTES || "No Notes";
            layer.bindPopup(
              `<div class="popup-content">
                <h1>${name}</h1>
                <p><em>Type: ${feature.properties.Type}</em></p>
                <p>${notes}</p>
              </div>`
            );
          },
        }).addTo(map);
      })
      .catch((error) => {
        console.error("Error loading GeoJSON data:", error); // Debugging: log any errors
      });
  </script>
</html>